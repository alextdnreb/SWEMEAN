<!--
    Copyright (C) 2015 - present Juergen Zimmermann, Hochschule Karlsruhe

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->

<!-- Template Binding durch die Direktive ngIf -->
<!-- Eine Direktive ist eine Komponente ohne View -->

<section aria-label="Suchergebnis">
  <mat-card class="example-card">
    <mat-card-content>
      <mat-card-title>Suchergebnis</mat-card-title>
      <mat-card-subtitle>f&uuml;r Kunden</mat-card-subtitle>

      <swe-waiting *ngIf="waiting; else suchergebnis"></swe-waiting>

      <ng-template #suchergebnis>
        <div
          aria-label="Gefundene Kunden"
          *ngIf="kunden.length; else showErrorMsg"
        >
          <div>
            <i class="material-icons">folder_open</i>
            <span>Gefundene Kunden</span>
          </div>
          <div>
            <table
              mat-table
              [dataSource]="kunden"
              [@easeIn]="'in'"
              style="width: 100%;"
            >
              <ng-container matColumnDef="position">
                <th mat-header-cell *matHeaderCellDef>No.</th>
                <td mat-cell *matCellDef="let element; let i = index">
                  {{ i + 1 }}
                </td>
              </ng-container>
              <ng-container matColumnDef="ID">
                <th mat-header-cell *matHeaderCellDef>ID</th>
                <td mat-cell *matCellDef="let element">
                  {{ element._id }}
                </td>
              </ng-container>
              <ng-container matColumnDef="nachname">
                <th mat-header-cell *matHeaderCellDef>Nachname</th>
                <td mat-cell *matCellDef="let element">
                  {{ element.nachname }}
                </td>
              </ng-container>
              <ng-container matColumnDef="geschlecht">
                <th mat-header-cell *matHeaderCellDef>Geschlecht</th>
                <td mat-cell *matCellDef="let element">
                  {{ getGeschlecht(element.geschlecht) }}
                </td>
              </ng-container>
              <ng-container matColumnDef="email">
                <th mat-header-cell *matHeaderCellDef>E-Mail</th>
                <td mat-cell *matCellDef="let element">{{ element.email }}</td>
              </ng-container>
              <ng-container matColumnDef="interessen">
                <th mat-header-cell *matHeaderCellDef>Interessen</th>
                <td mat-cell *matCellDef="let element">
                  {{ mapInteressen(element.interessen) }}
                </td>
              </ng-container>
              <ng-container matColumnDef="kategorie">
                <th mat-header-cell *matHeaderCellDef>Kategorie</th>
                <td mat-cell *matCellDef="let element">
                  {{ element.kategorie }}
                </td>
              </ng-container>
              <ng-container matColumnDef="ort">
                <th mat-header-cell *matHeaderCellDef>Ort</th>
                <td mat-cell *matCellDef="let element">
                  {{ element.adresse.plz }} - {{ element.adresse.ort }}
                </td>
              </ng-container>
              <ng-container matColumnDef="details">
                <th mat-header-cell *matHeaderCellDef></th>
                <td mat-cell *matCellDef="let element">
                  <a
                    [routerLink]="['..', element._id]"
                    title="Details anzeigen"
                  >
                    <i class="material-icons">search</i>
                  </a>
                </td>
              </ng-container>
              <ng-container matColumnDef="loeschen" *ngIf="isAdmin">
                <th mat-header-cell *matHeaderCellDef></th>
                <td mat-cell *matCellDef="let element">
                  <span
                    (click)="onRemove(element)"
                    title="Entfernen"
                    style="cursor: pointer;"
                  >
                    <i class="material-icons">delete</i>
                  </span>
                </td>
              </ng-container>
              <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
            </table>
          </div>
          <div>
            <div>
              <i class="material-icons">info</i>
              <span [ngPlural]="kunden.length">
                <!-- zu vergleichender Ausdruck -->
                <ng-template ngPluralCase="=0">
                  Es gibt keine Kunden
                </ng-template>
                <ng-template ngPluralCase="=1">
                  Es gibt einen Kunden
                </ng-template>
                <ng-template ngPluralCase="other">
                  Es gibt {{ kunden.length }} Kunden
                </ng-template>
              </span>
            </div>
          </div>
        </div>

        <!-- Ausgabe im Webbrowser statt console.log(...) -->
        <!-- <pre>{{kunden | json}}</pre> -->

        <ng-template #showErrorMsg>
          <swe-error-message [text]="errorMsg"></swe-error-message>
        </ng-template>
      </ng-template>
    </mat-card-content>
  </mat-card>
</section>
